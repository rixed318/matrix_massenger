# Knowledge Base Workflow

Эта заметка описывает процесс работы с базой знаний Matrix Messenger для администраторов организаций.

## Создание статей

1. Любое сообщение из чата можно сохранить в базу знаний. В панели действий сообщения выберите кнопку **«Сохранить в базу знаний»**.
2. В открывшемся диалоге укажите заголовок, при необходимости отредактируйте текст и добавьте теги.
3. Выберите пространство (Space) и канал, куда будет опубликована статья. По умолчанию используется тот же канал, откуда было взято исходное сообщение.
4. При сохранении фиксируются ссылки на исходные события Matrix (`roomId` + `eventId`). Это позволяет восстановить контекст и подтвердить происхождение материала.

Аналогичный диалог доступен из просмотра тредов — кнопка **«Опубликовать как статью»** собирает весь тред в единый материал.

## Поиск и каталог статей

- Раздел «База знаний» отображается в панели каналов, а также в панели общих материалов.
- Доступны фильтры по Space, каналу и тегам, а также полнотекстовый поиск по локальному индексу. Индекс обновляется автоматически через `localIndexStore` после каждого нового документа.
- Для быстрой навигации используйте дополнительные фильтры и сортировки внутри панели.

## Аудит и соответствие требованиям

- Все документы сохраняются как события Matrix типа `com.matrix_messenger.doc` в выбранном канале.
- Содержимое события включает метаданные: заголовок, краткое описание, список тегов, ссылки на исходные сообщения и информацию об авторе.
- При экспорте журналов подозрительных событий (см. `secureCloudService.exportSuspiciousEventsLog`) можно включить сведения о связанных статьях базы знаний. Это упрощает проверку действий сотрудников и формирование отчётности для комплаенса.

## Рекомендации по администрированию

- Настройте выделенный Space/канал для публикации внутренних процедур и знаний, чтобы отделить их от обычного общения.
- Используйте теги для обозначения версий документов, ответственных подразделений и уровней доступа.
- Регулярно выгружайте журнал с флагом включения документов для выполнения требований внутреннего аудита или проверок регуляторов.

## Технические детали

- Индексация статей происходит локально; при работе в десктопном приложении запись ведётся в SQLite через Tauri, в браузере используется IndexedDB.
- Для восстановления контекста достаточно хранить экспортированный JSON из журнала событий и сопутствующие файлы Knowledge Base.

